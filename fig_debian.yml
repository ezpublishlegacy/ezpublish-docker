dbvol:
  image: debian:wheezy
  volumes:
   - volumes/mysql:/var/lib/mysql
ezpublishvol:
  image: debian:wheezy
  volumes:
   - volumes/ezpublish:/var/www
composercachevol:
  image: debian:wheezy
  volumes:
   - volumes/composercache:/volumes/composercache
db1:
  build: dockerfiles/debian/mysql
  volumes_from:
   - dbvol
  environment:
   - MYSQL_PASS
prepare:
  build: dockerfiles/debian/ezpublish/prepare
  links:
   - db1:db
  volumes_from:
   - ezpublishvol
   - composercachevol
  volumes:
   - ${EZ_TARBALL_FILENAME}:/tmp/ezpublish.tar.gz
  environment:
   - EZ_KICKSTART
   - EZ_PACKAGEURL
   - EZ_INSTALLTYPE
   - EZ_COMPOSERVERSION
   - EZ_COMPOSERREPOSITORYURL
phpfpm:
  build: dockerfiles/debian/php-fpm
  links:
   - db1:db
  volumes_from:
   - ezpublishvol
nginx:
  build: dockerfiles/debian/nginx
  links:
   - phpfpm:php_fpm
  volumes_from:
   - ezpublishvol
  ports:
   - "8080:80"
